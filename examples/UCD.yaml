---
encoder:
   name: odb

 output: test_output.odb

source:
  name: multi-file
  paths:
    - test_data/UCD

preprocessing:
  #- match: (?P<dataset>test_data)/UCD/AirQuality_(?P<index>\d+)
  - match: (?P<dataset>test_data)/UCD/AirQuality_^(?:(?!~\$).)+\.(?:csv?)$
    metadata:
      class: sample
    parser:
      name: csv
      header: true
      metadata_columns:
        - title: TIME
          type: datetime
          identifying: true
          date_format: "%Y-%m-%d %H:%M:%S%z"
          name: an
        - title: BATT
          name: battery
          unit: V
      value_columns:
        - title: CCS811_ECO2
          name: environmental_carbon_dioxide
          unit: ppmV
        - title: CCS811_VOCS
          name: volatile_organic_carbons
          unit: gV
        - title: HUM
          name: relative_humidity
          unit: %
        - title: LIGHT
          name: light
          unit: W m**-2
        - title: NOISE_A
          name: noise_level
          unit: dB
        - title: PM_1
          name: particulate_matter_le_0_1_ug
          unit: ug_m**-3
        - title: PM_10
          name: particulate_matter_le_10_ug
          unit: ug_m**-3
        - title: PM_25
          name: particulate_matter_le_2_5_ug
          unit: ug_m**-3
        - title: PRESS
          name: pressure
          unit: psi
        - title: TEMP
          name: air_temperature
          unit: C

  #- match: (?P<dataset>test_data)/UCD/Traffic_(?P<index>\d+)
  - match: (?P<dataset>test_data)/UCD/Traffic_^(?:(?!~\$).)+\.(?:csv?)$
    metadata:
      class: sample
    parser:
      name: csv
      header: true
      metadata_columns:
        - title: instance_id
        - title: segment_id
        - title: date
          type: datetime
          identifying: true
          date_format: "%Y-%m-%d %H:%M:%SZ"
          name: an
        - title: interval
        - title: uptime
        - title: timezone
      value_columns:
        - title: heavy
        - title: car
        - title: bike
        - title: pedestrian
        - title: heavy_lft
        - title: heavy_rgt
        - title: car_lft
        - title: car_rgt
        - title: bike_lft
        - title: bike_rgt
        - title: pedestrian_lft
        - title: pedestrian_rgt
        - title: direction
        - title: car_speed_hist_0to70plus
        - title: car_speed_hist_0to120plus
        - title: v85
          name: car_speed_percentile_85
